<template>
<!--	<require from="./converters/percent"></require>
	<require from="./converters/round"></require>
	<require from="./converters/idealplanetsize"></require>-->
	
	<div class="planet atm${planet.atm} tmp${planet.temp} grav${planet.grav}" css="min-height:${(planet.size)|idealplanetsize}px; background-size: auto ${(planet.size)|idealplanetsize}px; background-position: 50% -${planet.size/2}px ;"><!-- calc(100% + ${planet.size}px) -->
		
		<nav>
			<!-- add to constellation button when debugging is over: planet.owner.id == theapp.iam -->
			<a href="#" class="button left" click.delegate="PressStarButton()"> STAR </a><a href="#" class="button center" click.delegate="PressConstelButton()" if.bind="planet.owner"> CONSTL </a><a href="#" class="button right" click.delegate="OpenDetailsPane()"> INFO </a>
			<a href="#" class="button left" click.delegate="PressPrevPlanetButton()"> PREV </a><a href="#" class="button right" click.delegate="PressNextPlanetButton()"> NEXT </a>
		</nav>
		
		<!-- NOTE: using one-time binding to avoid brief moment when the 
		object is undefined and browser tries to ask server for 'undefined' -->
<!-- 		<img if.bind="planet.owner" class="flag" src.bind="planet.owner.flag_img" /> -->
		<h2 if.bind="planet.owner" css="
		background-image: linear-gradient( to right, 
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},0) 0%     ,
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},1) 25%    ,
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},1) 75%    ,
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},0) 100%
			);
		">${planet.name}</h2>
		<h2 if.bind="!planet.owner">${planet.name}</h2>
		<p class="age" if.bind="planet.age_level">${'ðŸŸŠ'.repeat(planet.age_level)}</p>
		<div class="phys">
	
			<p class="env_label">${planet.gravDisplayName} ${planet.envDisplayName}
<!-- 						<span style="font-size: 150%;">${planet.size}</span>  -->
			</p>
			
			<div class="size">
				<span class="pop" if.bind="planet.owner !== false">${planet.total_pop|round} / ${planet.maxpop|round}<br/><span class="pop">POP / MAX</span></span>
				<span class="size">${planet.size}<br/><span class="size">SIZE</span></span>					
				<span class="${habitable ? (habitat < 0 ? 'alert' : 'good') : 'bad'}">	
					${(habitat >= 0 ? '+' : '')}${habitat}<br /> 
					<span class="">${habitable ? "HABITABILITY" : "UNINHABITABLE"}</span>
				</span>
				<span if.bind="planet.owner !== false">
					<img src.bind="planet.morale | moraleToMoodIcon"  style="width: 1.1em; height: 1.1em;" /><br/>
				</span>
			</div>
<!--					<p class="bold ${habitable ? (habitat < 0 ? 'alert' : 'good') : 'bad'}">	
			${(habitat >= 0 ? '+' : '')}${habitat} <span class="">${habitable ? "HABITABILITY" : "UNINHABITABLE"}</span>
			</p>-->
<!-- 					<p class="env_stats">ATM:${planet.atm} TMP:${planet.temp} GRAV:${planet.grav}</p> -->
						
			<p style="font-size: 1.0rem" class="goodies">
				<span>
					<svg class="icon icon-nature-1"><use xlink:href="#icon-nature-1"></use></svg>
					${planet.sect.mine.pow|round:1}x
				</span>
				<span>
					<svg class="icon icon-gear"><use xlink:href="#icon-gear"></use></svg>
					${planet.sect.prod.pow|round:1}x
				</span>
				<span>
					<svg class="icon icon-tool"><use xlink:href="#icon-tool"></use></svg>
					${planet.sect.sci.pow|round:1}x
				</span>
				<span>
					<svg class="icon icon-tool"><use xlink:href="#icon-tool"></use></svg>
					${planet.sect.sci.pow|round:1}x
				</span>
				<span>
					<svg class="icon icon-transport"><use xlink:href="#icon-transport"></use></svg>
					${planet.sect.def.pow|round:1}x
				</span>
			</p>	
		</div> 
		
<!--		<p>
			<span>
				<svg class="icon icon-nature-1"><use xlink:href="#icon-nature-1"></use></svg>
				${planet.sect.mine.pow|round:1}x
			</span>
			<span>
				<svg class="icon icon-gear"><use xlink:href="#icon-gear"></use></svg>
				${planet.sect.prod.pow|round:1}x
			</span>
			<span>
				<svg class="icon icon-tool"><use xlink:href="#icon-tool"></use></svg>
				${planet.sect.sci.pow|round:1}x
			</span>
			<span>
				<svg class="icon icon-building"><use xlink:href="#icon-building"></use></svg>
				${planet.sect.gov.pow|round:1}x
			</span>
			<span>
				<svg class="icon icon-transport"><use xlink:href="#icon-transport"></use></svg>
				${planet.sect.def.pow|round:1}x
			</span>
			<span>
				<svg class="icon icon-medical"><use xlink:href="#icon-medical"></use></svg>
				${planet.sect.esp.pow|round:1}x
			</span>
		</p>-->
		
<!--		<table style="font-size: 10px; font-weight:bold; ">

			<tr style="color: orange;">
				<th style="text-align:right;">MINING:</th>
				<td>${planet.sect.mine.pow|planetSectPow}</td>
			</tr>
			<tr style="color: red;">
				<th style="text-align:right;">PRODUCTION: </th>
				<td>${planet.sect.prod.pow|planetSectPow}</td>
			</tr>
			<tr style="color: yellow;">
				<th style="text-align:right;">GOVERNMENT:</th>
				<td>${planet.sect.gov.pow|planetSectPow}</td>
			</tr>
			<tr style="color: green;">
				<th style="text-align:right;">SCIENCE:</th>
				<td>${planet.sect.sci.pow|planetSectPow}</td>
			</tr>
			<tr style="color: cyan;">
				<th style="text-align:right;">DEFENSE:</th>
				<td>${planet.sect.def.pow|planetSectPow}</td>
			</tr>
			<tr style="color: magenta;">
				<th style="text-align:right;">ESPIONAGE:</th>
				<td>${planet.sect.esp.pow|planetSectPow}</td>
			</tr>
		</table>	-->	
		
		
		
<!-- 		<p class="alert" if.bind="planet.econ.mine_export < 0">Not enough resources</p> -->
		
		<!-- Physical attributes -->
<!--		<div class="phys">
			<div style="background-color: rgba(0,0,0,0.35); padding: 0.5em 1em; margin: 1em -1em;" class="clearfix">
			
				<div class="env" style="float: left; clear:left;">
					<div class="env_box">
						<div if.bind="app.options.debug" class="race_target" css="
							position:absolute;
							width:20%; height:20%;
							text-align:center; 
							margin-top: ${planet.owner.race.env.temp * 20}%;
							margin-left: ${planet.owner.race.env.atm * 20}%;
							color: #888;
							text-shadow: none;
							">${['ðŸž¡','ðŸž¢','ðŸž£','ðŸž¤','âœš'][planet.owner.race.env.grav]}</div>
						<div class="target"></div>
						<div class="hab">${(habitat >= 0 ? '+' : '')}${habitat}</div>
					</div>
				</div>
				<div style=" margin-left: 105px; text-align:left;">
					<p class="env_label">${planet.gravDisplayName} ${planet.envDisplayName}
						<span style="font-size: 150%;">${planet.size}</span> 
					</p>
					<p class="env_stats">ATM:${planet.atm} TMP:${planet.temp} GRAV:${planet.grav}</p>
					<p class="bold ${habitable ? (habitat < 0 ? 'alert' : 'good') : 'bad'}">	
					${(habitat >= 0 ? '+' : '')}${habitat} <span class="">${habitable ? "HABITABILITY" : "UNINHABITABLE"}</span>
					</p>			
					<p style="font-size: 1.215rem">
						<span>
							<svg class="icon icon-nature-1"><use xlink:href="#icon-nature-1"></use></svg>
							${planet.sect.mine.pow|round:1}x
						</span>
						<span>
							<svg class="icon icon-gear"><use xlink:href="#icon-gear"></use></svg>
							${planet.sect.prod.pow|round:1}x
						</span>
						<span>
							<svg class="icon icon-tool"><use xlink:href="#icon-tool"></use></svg>
							${planet.sect.sci.pow|round:1}x
						</span>
						<span>
							<svg class="icon icon-tool"><use xlink:href="#icon-tool"></use></svg>
							${planet.sect.sci.pow|round:1}x
						</span>
						<br/>
						<span>
							<svg class="icon icon-building"><use xlink:href="#icon-building"></use></svg>
							${planet.sect.gov.pow|round:1}x
						</span>
						<span>
							<svg class="icon icon-transport"><use xlink:href="#icon-transport"></use></svg>
							${planet.sect.def.pow|round:1}x
						</span>
						<span>
							<svg class="icon icon-medical"><use xlink:href="#icon-medical"></use></svg>
							${planet.sect.esp.pow|round:1}x
						</span>
						<span>
							<svg class="icon icon-tool"><use xlink:href="#icon-tool"></use></svg>
							${planet.sect.sci.pow|round:1}x
						</span>
					</p>			
				</div>
			</div>
		</div> -->
		
		<template containerless if.bind="app.options.see_all || planet.owner == app.game.myciv">
			
			<!-- Spending Levels -->
			<div class="spending" if.bind="planet.owner">
				<div class="spending_stackbar"><!-- css="width:${planet.slider_spending / planet.max_spending | percent:3}%" -->
					<div class="p" css="width:${planet.sect.prod.pct | percent:3}%">P<!--${planet.sect.prod.output | round:1}--></div>
					<div class="m" css="width:${planet.sect.mine.pct | percent:3}%">M<!--${planet.sect.mine.output | round:1}--></div>
					<div class="e" css="width:${planet.sect.esp.pct | percent:3}%">E<!--${planet.sect.esp.output | round:1}--></div>
					<div class="s" css="width:${planet.sect.sci.pct | percent:3}%">S<!--${planet.sect.sci.output | round:1}--></div>
<!-- 					<div class="g" css="width:${planet.sect.gov.pct | percent:3}%">G</div> -->
					<div class="d" css="width:${planet.sect.def.pct | percent:3}%">D<!--${planet.sect.def.output | round:1}--></div>
	<!-- 				<div class="m" css="width:${planet.sect.com.pct | percent:3}%"></div> -->
				</div>
				<div class="p"><span>PROD</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_prod" /><span>${planet.sect.prod.output|round:1}âžž${planet.sect.prod.work|round:1}&nbsp;${planet.sect.prod.growth > 0.01 ? 'â–²' : (planet.sect.prod.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
				<div class="m"><span>MINE</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_mine" /><span>${planet.sect.mine.output|round:1}âžž${planet.sect.mine.work|round:1}&nbsp;${planet.sect.mine.growth > 0.01 ? 'â–²' : (planet.sect.mine.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
				<div class="e"><span>ESP</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_esp" /><span>${planet.sect.esp.output|round:1}âžž${planet.sect.esp.work|round:1}&nbsp;${planet.sect.esp.growth > 0.01 ? 'â–²' : (planet.sect.esp.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
				<div class="s"><span>SCI</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_sci" /><span>${planet.sect.sci.output|round:1}âžž${planet.sect.sci.work|round:1}&nbsp;${planet.sect.sci.growth > 0.01 ? 'â–²' : (planet.sect.sci.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
<!-- 				<div class="g"><span>GOV</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_gov" /><span>${planet.sect.gov.output|round:1}âžž${planet.sect.gov.work|round:1}&nbsp;${planet.sect.gov.growth > 0.01 ? 'â–²' : (planet.sect.gov.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div>  -->
				<div class="d"><span>DEF</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_def" /><span>${planet.sect.def.output|round:1}âžž${planet.sect.def.work|round:1}&nbsp;${planet.sect.def.growth > 0.01 ? 'â–²' : (planet.sect.def.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
	<!-- 			<div class="c"><span>COM</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_com" /><span>${planet.sect.com.output|round:1}âžž${planet.sect.com.work|round:1}&nbsp;${planet.sect.com.growth > 0.01 ? 'â–²' : (planet.sect.com.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div>  -->
				<br/>
				<div class="t"><span>TAX</span><input type="range"  min="0" max="0.5" step="0.01" value.bind="planet.slider_taxrate" /><span>${planet.tax_rate | percent}%</span></div> 
				<div class="th"><span>SPEND</span><input type="range" min="0" max.bind="planet.max_spending" step="0.01" value.bind="planet.slider_spending" /><span>${planet.spending | percent}%</span></div> 
			</div>
			
			<!-- Colony Data -->
			<div class="data" if.bind="planet.owner">
				<span class="${planet.treasury_contrib >= 0 ? 'good' : 'bad'}">Taxes: ${planet.treasury_contrib >= 0 ? '+' : ''}${planet.treasury_contrib|round:1}</span>,
				<span if.bind="planet.mp_export >= 0" class="good">Exporting: ${planet.mp_export|round:1}</span>
				<span if.bind="planet.mp_export < 0" class="alert">Importing: ${-planet.mp_export|round:1}</span>,
				<span>Warehouse: ${planet.warehouse|round:1}</span>
				<br />
				<span>GDP: ${planet.econ.GDP|round:1}</span>
				<span>PCI: ${planet.econ.PCI|round:1} âžž ${planet.econ.target_PCI|round:1} </span>
	<!-- 			<span>GF: ${planet.econ.GF|round:4}</span> -->
				<span>TradeGoods: ${planet.econ.tradegoods|round:1}</span>
				<span>Morale: ${planet.morale|round:2}</span>
				<br />
				<br />
				
				<h3>Now Building:</h3>
				<table class="prod_queue">
					<tr repeat.for="item of planet.prod_q">
						<td>${item.turns_left}</td>
						<td><progress max="100" value="${item.pct|round}"></progress><p>${item.obj.name}</p></td>
						<td><a href="#" click.delegate="BuildQueueMoveItemUp($index)" if.bind="$index > 0">â–²</a></td>
						<td><a href="#" click.delegate="BuildQueueMoveItemDown($index)" if.bind="$index != (planet.prod_q.length-1)">â–¼</a></td>
						<td>
							<select value.bind="item.quantity">
								<option repeat.for="option of prod_q_repeat_vals" model.bind="option.value">${option.name}</option>
							</select>			
						</td>
						<td><a href="#" click.delegate="BuildQueueRemoveItem($index)" class="bad">X</a></td>
					</tr>
				</table>
				<p>
					<select value.bind="sel_build_item">
						<option repeat.for="bp of planet.owner.ship_blueprints" model.bind="bp">${bp.name}</option>
						<option repeat.for="bp of planet.owner.groundunit_blueprints" model.bind="bp">${bp.name}</option>
					</select>
					<button click.delegate="AddSelectedItemToBuildQueue()">Add</button>
				</p>
				
			</div>
			
			<div class="defenses">
				<h3>Defenses:</h3>
				<div class="trooplist">
					<img src="img/ground/tank_transp.png" 
						style="
							height: 32px; 
							width: 32px; 
							display: inline-block; 
							border: 1px solid white; 
							border-radius: 0.25em; 
							overflow: hidden; 
							padding: 0.25em; 
							margin: 0 0.5em 0.5em 0;
							"
						repeat.for="t of planet.troops"
						click.delegate="t.selected = !t.selected";
					/>
				</div>
			</div>
		</template>
		
	</div>
</template>
