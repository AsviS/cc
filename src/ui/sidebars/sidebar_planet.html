<template>

	<div class="planet atm${planet.atm} tmp${planet.temp} grav${planet.grav}" css="min-height:${(planet.size)|idealplanetsize}px; background-size: auto ${(planet.size)|idealplanetsize}px; background-position: 50% -${planet.size/2}px ;"><!-- calc(100% + ${planet.size}px) -->
		
		<p class="button_rack button_rack_fill small">
			<button click.delegate="OpenDetailsPane()">INFO</button>
			<button click.delegate="PressStarButton()">STAR</button>
			<button click.delegate="PressPrevPlanetButton()">â—€</button>
			<button click.delegate="PressNextPlanetButton()">â–¶</button>
			<button if.bind="planet.owner == app.game.myciv"
				click.delegate="ToggleStagingPoint()" 
					class="${planet.star.accts.get(planet.owner).ai.staging_pt ? 'alt' : ''}">âœœSTAGING</button>
		</p>
						
		<!-- enemy fleet attack option --> 
		<p class="button_rack button_rack_fill" if.bind="planet.settled && !planet.owner.is_player && playerHasLocalFleet">
			<button class="alt" click.delegate="AttackTargetWithLocalFleet()">ATTACK</button>
		</p>
		
		<!-- NOTE: using one-time binding to avoid brief moment when the 
		object is undefined and browser tries to ask server for 'undefined' -->
<!-- 		<img if.bind="planet.owner" class="flag" src.bind="planet.owner.flag_img" /> -->
		<h2 if.bind="planet.owner" css="
		background-image: linear-gradient( to right, 
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},0) 0%     ,
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},1) 25%    ,
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},1) 75%    ,
			rgba(${planet.owner.color_rgb[0]},${planet.owner.color_rgb[1]},${planet.owner.color_rgb[2]},0) 100%
			);
		">${planet.name}</h2>
		<h2 if.bind="!planet.owner">${planet.name}</h2>
		<p class="age" if.bind="planet.age_level">${'ðŸŸŠ'.repeat(planet.age_level)}</p>
		
		<div class="phys">
	
			<p class="env_label">${planet.gravDisplayName} ${planet.envDisplayName}
<!-- 						<span style="font-size: 150%;">${planet.size}</span>  -->
			</p>
			
			<div class="size">
				<span class="pop" if.bind="planet.owner !== false">${planet.total_pop|round} / ${planet.maxpop|round}<br/><span class="pop">POP / MAX</span></span>
				<span class="size">${planet.size}<br/><span class="size">SIZE</span></span>					
				<span class="${habitable ? (habitat < 0 ? 'alert' : 'good') : 'bad'}">	
					${(habitat >= 0 ? '+' : '')}${habitat}<br /> 
					<span class="">${habitable ? "HABITABILITY" : "UNINHABITABLE"}</span>
				</span>
				<span if.bind="planet.owner !== false">
					<img src.bind="planet.morale | moraleToMoodIcon"  style="width: 1.1em; height: 1.1em;" /><br/>
				</span>
			</div>
<!--					<p class="bold ${habitable ? (habitat < 0 ? 'alert' : 'good') : 'bad'}">	
			${(habitat >= 0 ? '+' : '')}${habitat} <span class="">${habitable ? "HABITABILITY" : "UNINHABITABLE"}</span>
			</p>-->
<!-- 					<p class="env_stats">ATM:${planet.atm} TMP:${planet.temp} GRAV:${planet.grav}</p> -->
						
		
			<div class="resources">
				<template repeat.for="k of planet.resources|props" containerless>
					<span repeat.for="i of planet.resources[k]" class="${k}"></span>
				</template>
			</div>
			
			
		</div> 
		
		<template containerless if.bind="app.options.see_all || planet.owner == app.game.myciv">
			
			<!-- Spending Levels -->
			<div class="spending" if.bind="planet.owner">
				<div class="spending_stackbar"><!-- css="width:${planet.slider_spending / planet.max_spending | percent:3}%" -->
					<div class="p" css="width:${planet.sect.prod.pct | percent:3}%">P</div>
					<div class="m" css="width:${planet.sect.mine.pct | percent:3}%">M</div>
<!-- 					<div class="e" css="width:${planet.sect.esp.pct | percent:3}%">E</div> -->
					<div class="s" css="width:${planet.sect.sci.pct | percent:3}%">S</div>
<!-- 					<div class="g" css="width:${planet.sect.gov.pct | percent:3}%">G</div> -->
<!-- 					<div class="d" css="width:${planet.sect.def.pct | percent:3}%">D</div> -->
	<!-- 				<div class="m" css="width:${planet.sect.com.pct | percent:3}%"></div> -->
				</div>
				<div class="p"><span>PROD</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_prod" /><span>${planet.sect.prod.output|round:1}âžž${planet.sect.prod.work|round:1}&nbsp;${planet.sect.prod.growth > 0.01 ? 'â–²' : (planet.sect.prod.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
				<div class="m"><span>MINE</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_mine" /><span>${planet.sect.mine.output|round:1}âžž${planet.sect.mine.work|round:1}&nbsp;${planet.sect.mine.growth > 0.01 ? 'â–²' : (planet.sect.mine.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
<!-- 				<div class="e"><span>ESP</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_esp" /><span>${planet.sect.esp.output|round:1}âžž${planet.sect.esp.work|round:1}&nbsp;${planet.sect.esp.growth > 0.01 ? 'â–²' : (planet.sect.esp.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div>  -->
				<div class="s"><span>SCI</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_sci" /><span>${planet.sect.sci.output|round:1}âžž${planet.sect.sci.work|round:1}&nbsp;${planet.sect.sci.growth > 0.01 ? 'â–²' : (planet.sect.sci.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div> 
<!-- 				<div class="g"><span>GOV</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_gov" /><span>${planet.sect.gov.output|round:1}âžž${planet.sect.gov.work|round:1}&nbsp;${planet.sect.gov.growth > 0.01 ? 'â–²' : (planet.sect.gov.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div>  -->
<!-- 				<div class="d"><span>DEF</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_def" /><span>${planet.sect.def.output|round:1}âžž${planet.sect.def.work|round:1}&nbsp;${planet.sect.def.growth > 0.01 ? 'â–²' : (planet.sect.def.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div>  -->
	<!-- 			<div class="c"><span>COM</span><input type="range" min="0" max="1.0" step="0.01" value.bind="planet.slider_com" /><span>${planet.sect.com.output|round:1}âžž${planet.sect.com.work|round:1}&nbsp;${planet.sect.com.growth > 0.01 ? 'â–²' : (planet.sect.com.growth < -0.01 ? 'â–¼' : '\u2003')}</span></div>  -->
				<br/>
				<div class="t"><span>TAX</span><input type="range"  min="0" max="0.5" step="0.01" value.bind="planet.slider_taxrate" /><span>${planet.tax_rate | percent}%</span></div> 
				<div class="th"><span>SPEND</span><input type="range" min="0" max.bind="planet.max_spending" step="0.01" value.bind="planet.slider_spending" /><span>${planet.spending | percent}%</span></div> 
			</div>
			
			<!-- Colony Data -->
			<div class="data" if.bind="planet.owner">
				
				<!-- DEBUG -->
				<div if.bind="app.options.debug">
					<span class="${planet.treasury_contrib >= 0 ? 'good' : 'bad'}">Taxes: ${planet.treasury_contrib >= 0 ? '+' : ''}${planet.treasury_contrib|round:1}</span>,
					<span if.bind="planet.mp_export >= 0" class="good">Exporting: ${planet.mp_export|round:1}</span>
					<span if.bind="planet.mp_export < 0" class="alert">Importing: ${-planet.mp_export|round:1}</span>,
					<span>Warehouse: ${planet.warehouse|round:1}</span>
					<br />
					<span>GDP: ${planet.econ.GDP|round:1}</span>
					<span>PCI: ${planet.econ.PCI|round:1} âžž ${planet.econ.target_PCI|round:1} </span>
		<!-- 			<span>GF: ${planet.econ.GF|round:4}</span> -->
					<span>TradeGoods: ${planet.econ.tradegoods|round:1}</span>
					<span>Morale: ${planet.morale|round:2}</span>
					<br />
					<br />
				</div>
				
				<h3>Now Building:</h3>
				<table class="prod_queue">
					<tr repeat.for="item of planet.prod_q">
						<td>${item.turns_left}</td>
						<td><progress max="100" value="${item.pct|round}"></progress><p>${item.name}</p></td>
						<td><a href="#" click.delegate="BuildQueueMoveItemUp($index)" if.bind="$index > 0">â–²</a></td>
						<td><a href="#" click.delegate="BuildQueueMoveItemDown($index)" if.bind="$index != (planet.prod_q.length-1)">â–¼</a></td>
						<td>
							<select value.bind="item.qty">
								<option repeat.for="option of prod_q_repeat_vals" model.bind="option.value">${option.name}</option>
							</select>			
						</td>
						<td><a href="#" click.delegate="BuildQueueRemoveItem($index)" class="bad">X</a></td>
					</tr>
				</table>
				<p>
					<select value.bind="sel_build_item">
						<option repeat.for="bp of planet.owner.ship_blueprints" model.bind="bp">${bp.name}</option>
						<option repeat.for="bp of planet.owner.groundunit_blueprints" model.bind="bp">${bp.name}</option>
						<option repeat.for="bp of planet.ListMakeworkProjects()" model.bind="bp">${bp.name}</option>
					</select>
					<button click.delegate="AddSelectedItemToBuildQueue()">Add</button>
				</p>
				<p class="clickable" click.delegate="OpenDetailsPane()">Send newly built ships to: 
					<b>${
						planet.ship_dest == '@' 
						? 'Nearest Staging Point'
						: (
							!planet.ship_dest 
							? 'Here'
							: planet.ship_dest.name
							) 
					}</b>
				</p>
			</div>
			
			<div class="defenses" if.bind="planet.owner">
				<h3>Defenses:</h3>
				<div repeat.for="[bp,count] of planet.ListUniqueGroundUnits()" style="display:inline-block;">
					<img src="img/ground/tank_transp.png" 
						style="
							height: 32px; 
							width: 32px; 
							display: inline-block; 
							border: 1px solid white; 
							border-radius: 0.25em; 
							overflow: hidden; 
							padding: 0.25em; 
							"
					/>&nbsp;x${count}&nbsp;
				</div>
			</div>
		</template>
		
	</div>
</template>
