<template>
<!--	<require from="./converters/percent"></require>
	<require from="./converters/round"></require>-->

	<!-- FLEET DISPLAY MODE -->
	<div class="fleet" if.bind="mode == 'fleet' || mode == 'awaiting_star_click'">
		<h2 css="color: ${fleet.ui_color};">${fleet.owner.name} Fleet #${fleet.id}</h2>
		<template containerless if.bind="app.options.see_all || fleet.owner == app.game.myciv">
			
			<p style="font-size: 150%;" class="big" if.bind="fleet.mission">On Mission. Back in [${fleet.mission.time}] turns.</p>
			<p style="font-size: 150%;" class="big" if.bind="!fleet.mission">Location: 
				<span if.bind="fleet.star">${fleet.star.name}</span>
				<span if.bind="fleet.dest"><span>âž </span> ${fleet.dest.name}</span>
			</p>
			
			<span if.bind="fleet.research">Research Capacity: <b>${fleet.research}</b></span>
			
			<!-- local anomoly research info -->
			<p if.bind="fleet.star && !fleet.dest && fleet.star.objtype == 'anom'">
				Anomaly Research: ${(app.game.turn_num*0) + fleet.star.AmountResearched( fleet.owner )} 
				<progress value.bind="(app.game.turn_num*0) + fleet.star.AmountResearched( fleet.owner ) / fleet.star.size" />
			</p>
			
			<!-- not on a deep space mission -->
			<template containerless if.bind="!fleet.mission">
			
				<p class="msg" style="font-weight:bold; color: #FAA;" if.bind="can_send==2">Right-click a star to move fleet</p>
				
				<!-- Fleet Actions -->
				<p class="button_rack" ><!--if.bind="mode=='fleet'"-->
					<a href="#" click.delegate="ClickClose()" class="bad" >CLOSE</a>
					<a href="#" click.delegate="ClickColonize()" if.bind="can_colonize" class="${can_colonize==2 ? 'alt' : 'ghost'}">COLONIZE</a>
					<a href="#" click.delegate="ClickChooseMission()" if.bind="can_research" class="${can_research==2 ? 'alt' : 'ghost'}">MISSION</a>
					<a href="#" click.delegate="ClickBomb()" if.bind="can_bomb" class="${can_bomb==2 ? 'alt' : 'ghost'}">BOMBARD</a>
					<a href="#" click.delegate="ClickInvade()" if.bind="can_invade" class="${can_invade==2 ? 'alt' : 'ghost'}" >INVADE</a>
					<a href="#" click.delegate="ClickScrap()" class="${num_selected ? 'alt' : 'ghost'}" >SCRAP</a>
				</p>
				
				<!-- Ship Selection --> 
				<p class="button_rack">
					<a href="#" click.delegate="SelectAll()" >ALL</a>
					<a href="#" click.delegate="SelectNone()" >NONE</a>
					<a href="#" click.delegate="SelectInvert()" >INVERT</a>
					<span>${num_selected}/${fleet.ships.length}</span>
				</p>
			
			</template>
			
		</template>
			
		
		<div class="shipgrid">
			<div class="ship ${ship.selected ? 'selected' : ''} health_${ship.health_class}" click.delegate="SelectShip(ship)" repeat.for="ship of fleet.ships" >
				<p class="infobar top"><span>${'ðŸŸŠ'.repeat(ship.xplevel)}</span><span>&nbsp;<span if.bind="ship.bp.shield">${ship.bp.shield}</span></span></p>
				<img src.one-time="ship.bp.img" />
				<p class="infobar hp"><span>${ship.hull}</span><span>${ship.armor}</span></p>
				<progress if.bind="ship.armor" max="100" value="${((ship.armor / ship.bp.armor)*100)|round}" class="${ship.health_class}"></progress>
				<progress if.bind="!ship.armor" max="100" value="${((ship.hull / ship.bp.hull)*100)|round}" class="${ship.health_class}"></progress>
				<p class="name">${ship.bp.name} </p>
			</div>
		</div>
	</div>
		
	<div class="fleet" if.bind="mode=='mission' && !fleet.mission" style="font-weight:bold; font-size: 150%;">
		<p>Send fleet on deep-space research mission? Fleet will be unavailable until it returns.</p>
		<p>How long should the mission last?</p>
		<p><input type="range" min="3" max="50" step="1" value.bind="mission_turns" /> ${mission_turns} turns</p>
		<p class="button_rack">
			<a href="#" click.delegate="ClickStartMission()" class="good" >START MISSION</a>
			<a href="#" click.delegate="ClickCancel()" class="bad" >CANCEL</a>
		</p>

	</div>
		
	<!-- CHOOSE-PLANET MODE -->
	<div class="star star_${fleet.star.color}" if.bind="mode == 'colonize' || mode == 'bomb' || mode == 'invade'">
		<h2>Colonize ${fleet.star.name}</h2>
		<p style="font-weight:bold; color: #FAA;" >Choose a planet to colonize:</p>
		<div repeat.for="p of fleet.star.planets" class="hilite_wrapper" if.bind="p.owner === false && p.Habitable(fleet.owner.race)" click.delegate="ChoosePlanetToColonize(p)">
			<div class="planet atm${p.atm} tmp${p.temp}" css.one-time="PlanetSizeCSS(p)">
				<p class="env_label"><span class="env_label">${p.envDisplayName}</span></p>
				<div class="env_box">
					<div class="target"></div>
				</div>	
				<h3 css="color: ${p.ui_color};">${p.name}</h3>
				<div class="phys">
					<div class="size">
						<span class="size">${p.size}<br/><span class="size">SIZE</span></span>							
						<span class="mine">${p.rich}x<br/><span class="mine">MINING</span></span>
						<span class="en">${p.energy}x<br/><span class="en">ENERGY</span></span>
						<span class="${p.Habitable(app.game.myciv.race) ? (p.Adaptation( app.game.myciv.race ) < 0 ? 'alert' : 'good') : 'bad'}">
							${(p.Adaptation( app.game.myciv.race ) >= 0 ? '+' : '')}${p.Adaptation( app.game.myciv.race )}<br/>
							<span class="">ENV</span>
						</span>					
					</div>			
				</div>
			</div>
		</div>
		<p class="button_rack">
			<a href="#" click.delegate="ClickCancel()" class="bad">CANCEL</a>
		</p>		
	</div>
	
</template>
