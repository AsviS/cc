<template containerless>
	<div id="tech_pane" class="pane flex">
		<header>
			<p class="button_rack marginless" style="float:right;">
				<button click.delegate="ChangeMode('available')" class="big ${mode=='available'?'alt':'cool'}">AVAILABLE</button>
				<button click.delegate="ChangeMode('completed')" class="big ${mode=='completed'?'alt':'cool'}">COMPLETED</button>
				<button click.delegate="ClosePanel()" class="big bad">CLOSE</button>
			</p>
			<h1>Research</h1>
		</header>
		
		<main>
			<div id="available" class="offset techlist" if.bind="mode=='available'">
				<p class="marginless" style="float:right"><b class="good">${app.game.myciv.research_income||0|round} RP</b> /turn</p>
				<h2>Available</h2>
				<p if.bind="!nodes_avail.length" class="bold center">No projects available</p>
				<div 
					repeat.for="n of nodes_avail" 
					class="${n == app.game.myciv.tech.current_project ? 'hilite' : ''}"
					click.delegate="ClickAvailableTech(n)"
					>
					<div class="techtags">
						<span class="techtag ${n.node.tags[0]}"></span>
					</div>
					<p>${n.node.name}</p>
					<p class="subtext">
						<!-- if researching, show turns remaining -->
						<span if.bind="app.game.myciv.research_income">
							<b if.bind="n.rp">
								${(n.node.rp - n.rp) / app.game.myciv.research_income | ceil}
							</b>
							<!-- otherwise show turns estimated -->
							<b else>
								${n.node.rp / app.game.myciv.research_income | ceil}
							</b> Turns  &nbsp;&nbsp; 
						</span>
						<b>${n.node.rp|round}</b> RP  &nbsp;&nbsp; 
					</p>
					<progress value="${n.rp}" max="${n.node.rp}" if.bind="n.rp"></progress>
				</div>
			</div>
			
			<div id="completed" class="offset techlist" if.bind="mode=='completed'">
				<h2>Completed</h2>
				<div repeat.for="n of nodes_compl" click.delegate="ClickCompletedTech(n)" class="${n == featured_node ? 'hilite' :''}">
					<div class="techtags">
						<span class="techtag ${n.tags[0]}"></span>
					</div>
					<p>${n.name}</p>
				</div>
			</div>
			
			<div id="featured" class="offset" if.bind="featured_node">
				<h2>${featured_node.name}</h2> 
				<p class="techtags">
					<span repeat.for="t of featured_node.tags" class="techtag ${t}">${t|uppercaseFirst}</span>
				</p>
				<p class="desc bold good">${featured_node.rp} RP</p>
				<!-- <img src.bind="featured_node.img" /> -->
				<div class="desc" innerhtml.bind="featured_node.desc"></div>
				<template containerless if.bind="featured_node.yields.length > 1">
					<p>Provides:</p>
					<ul>
						<li repeat.for="yield of featured_node.yields"> 
							<b>${Techs[yield].name}</b>
							${app.options.debug ? ('('+yield+')') : ''}
							<br/>
							<span class="dim" innerhtml.bind="Techs[yield].desc"></span>
						</li>
					</ul>
				</template>
				<!-- "requires" section isnt necessary for player because because they can't see it unless its already unlocked -->
				<template containerless if.bind="app.options.debug && featured_node.requires.length">
					<p>Requires:</p>
					<ul>
						<li repeat.for="req of featured_node.requires">
							<b>${TechNodes[req].name}</b>
							${app.options.debug ? ('('+req+')') : ''}
						</li>
					</ul>
				</template>
			</div>
			
		</main>
	</div>

</template>
